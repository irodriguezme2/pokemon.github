<div class="combate-container">
  <!-- üîπ Barra superior con informaci√≥n de ambos Pok√©mon -->
  <div class="info-superior">
    <div class="pokemon-info jugador">
      <div class="nombre">{{ pokemonJugador?.nombre | titlecase }}</div>
      <div class="hp-bar">
        <div
          class="hp"
          [style.width]="(pokemonJugador?.hp || 0) + '%'"
          [ngClass]="{
            verde: (pokemonJugador?.hp || 0) > 50,
            amarillo: (pokemonJugador?.hp || 0) <= 50 && (pokemonJugador?.hp || 0) > 20,
            rojo: (pokemonJugador?.hp || 0) <= 40
          }"
        ></div>
      </div>
    </div>

    <div class="pokemon-info invitado">
      <div class="nombre">{{ pokemonInvitado?.nombre | titlecase }}</div>
      <div class="hp-bar">
        <div
          class="hp"
          [style.width]="(pokemonInvitado?.hp || 0) + '%'"
          [ngClass]="{
            verde: (pokemonInvitado?.hp || 0) > 50,
            amarillo: (pokemonInvitado?.hp || 0) <= 50 && (pokemonInvitado?.hp || 0) > 20,
            rojo: (pokemonInvitado?.hp || 0) <= 20
          }"
        ></div>
      </div>
    </div>
  </div>
  <div class="escenario">
    <img
      class="sprite jugador"
      [src]="pokemonJugador?.imagen"
      [alt]="pokemonJugador?.nombre"
      [class.shake]="shakingJugador"
      [class.flash]="flashJugador"
    />

    <img
      class="sprite invitado"
      [src]="pokemonInvitado?.imagen"
      [alt]="pokemonInvitado?.nombre"
      [class.shake]="shakingInvitado"
      [class.flash]="flashInvitado"
    />
  </div>

    <div class="panel jugador-panel">

      <div class="menu-principal" *ngIf="turnoJugador && mostrandoMenu">
        <div class="texto">¬øQu√© deber√≠a hacer {{ pokemonJugador?.nombre }}?</div>
        <div class="opciones">
          <button (click)="elegirAtacar()">ATACAR</button>
          <button (click)="elegirCambiar()">POK√âMON</button>
          <button (click)="escapar()">CORRER</button>
        </div>
      </div>

    <!-- üü£ Men√∫ de ataques -->
      <div class="ataques" *ngIf="mostrandoAtaques">
        <button *ngFor="let mov of movimientos" (click)="usarMovimiento(mov)">
          {{ mov.nombre }}
        </button>
        <button class="volver" (click)="volverAlMenu()">‚ÜêVOLVER</button>
      </div>

    <!-- üü° Men√∫ de cambio de Pok√©mon -->
      <div class="equipos" *ngIf="mostrandoCambio">
        <div class="miniaturas jugador">
          <ng-container *ngFor="let p of equipoJugador">
            <img
              *ngIf="p.vivo"
              [src]="p.imagen"
              [alt]="p.nombre"
              (click)="cambiarPokemon(p)"
              [class.activo]="p.nombre === pokemonJugador?.nombre"
            />
          </ng-container>
        </div>
        <button class="volvercam" (click)="volverAlMenu()">‚Üê VOLVER</button>
      </div>
    </div>
</div>

<p-dialog
  [(visible)]="dialogMensajeVisible"
  [modal]="true"
  [closable]="false"
  class="dialog-mensaje">
  <h3 class="dialog-mensaje-titulo">¬°Atenci√≥n!</h3>
  <p class="dialog-mensaje-texto">{{ mensajeDialogo }}</p>
  <div class="dialog-botones">
    <p-button label="OK" icon="pi pi-check" (onClick)="dialogMensajeVisible = false"></p-button>
  </div>
</p-dialog>
